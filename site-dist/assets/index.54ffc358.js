var J=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var N=(e,n,t)=>n in e?J(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,x=(e,n)=>{for(var t in n||(n={}))W.call(n,t)&&N(e,t,n[t]);if(V)for(var t of V(n))X.call(n,t)&&N(e,t,n[t]);return e},C=(e,n)=>K(e,Q(n));import{c as $,i as R,H as U,u as ee}from"./use-translate.f00dec62.js";import{t as j,b as P,m as w,c as ne,w as S,d as oe,a as _}from"./with-install.8c05f7e9.js";import{C as te}from"./index.45245c12.js";import{z as k,e as o,B as l,D as ae,x as A,E as se,j as ce,v as ue,q as ie,C as I,r as le,o as de,c as re,w as z,A as g}from"./vue-libs.dea03542.js";import{P as me}from"./index.b6a5a3b7.js";import{u as pe}from"./use-refs.ca62e258.js";import{T as he,a as q}from"./index.85b17bff.js";import{F as be}from"./index.cdcf7a30.js";import{B as Y}from"./index.04cdfa9b.js";import{C as fe}from"./index.9325a2e4.js";import{T as ge}from"./function-call.371c5c4a.js";import"./use-route.8c8b61a6.js";import"./index.bd074117.js";import"./interceptor.3309ba7f.js";import"./use-expose.e5d76f3d.js";import"./use-touch.8bab3413.js";import"./index.c020d7aa.js";import"./utils.51167448.js";import"./index.9fc8b336.js";import"./use-lazy-render.4ae98f04.js";import"./on-popup-reopen.f4e064e0.js";import"./index.3d14facd.js";import"./index.f3fd5100.js";import"./useChildren.3c3a8afb.js";import"./useParent.e8f23fef.js";import"./constant.bdedcaa1.js";import"./index.d1cfdb12.js";import"./index.d48d155f.js";import"./index.91fa2961.js";import"./Checker.f421b064.js";import"./mount-component.d70fed1c.js";const[ve,G,L]=$("coupon-cell");function xe(e,n,t){const u=e[+n];if(u){let a=0;return R(u.value)?{value:a}=u:R(u.denominations)&&(a=u.denominations),`-${t} ${(a/100).toFixed(2)}`}return e.length===0?L("noCoupon"):L("count",e.length)}var Ce=k({name:ve,props:{title:String,border:j,editable:j,coupons:P(),currency:w("\xA5"),chosenCoupon:ne(-1)},setup(e){return()=>{const n=e.coupons[+e.chosenCoupon],t=xe(e.coupons,e.chosenCoupon,e.currency);return o(te,{class:G(),value:t,title:e.title||L("title"),border:e.border,isLink:e.editable,valueClass:G("value",{selected:n})},null)}}});const je=S(Ce),[we,d,M]=$("coupon");function H(e){const n=new Date(e*1e3);return`${n.getFullYear()}.${U(n.getMonth()+1)}.${U(n.getDate())}`}const Be=e=>(e/10).toFixed(e%10==0?0:1),O=e=>(e/100).toFixed(e%100==0?0:e%10==0?1:2);var ye=k({name:we,props:{chosen:Boolean,coupon:oe(Object),disabled:Boolean,currency:w("\xA5")},setup(e){const n=l(()=>{const{startAt:a,endAt:s}=e.coupon;return`${H(a)} - ${H(s)}`}),t=l(()=>{const{coupon:a,currency:s}=e;if(a.valueDesc)return[a.valueDesc,o("span",null,[a.unitDesc||""])];if(a.denominations){const i=O(a.denominations);return[o("span",null,[s]),` ${i}`]}return a.discount?M("discount",Be(a.discount)):""}),u=l(()=>{const a=O(e.coupon.originCondition||0);return a==="0"?M("unlimited"):M("condition",a)});return()=>{const{chosen:a,coupon:s,disabled:i}=e,b=i&&s.reason||s.description;return o("div",{class:d({disabled:i})},[o("div",{class:d("content")},[o("div",{class:d("head")},[o("h2",{class:d("amount")},[t.value]),o("p",{class:d("condition")},[s.condition||u.value])]),o("div",{class:d("body")},[o("p",{class:d("name")},[s.name]),o("p",{class:d("valid")},[n.value]),!i&&o(fe,{class:d("corner"),modelValue:a},null)])]),b&&o("p",{class:d("description")},[b])])}}});const Z=S(ye),[De,r,v]=$("coupon-list"),ke="https://img.yzcdn.cn/vant/coupon-empty.png";var Ee=k({name:De,props:{code:w(""),coupons:P(),currency:w("\xA5"),showCount:j,emptyImage:w(ke),chosenCoupon:_(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:P(),showExchangeBar:j,showCloseButton:j,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:_(1),exchangeButtonText:String,displayedCouponIndex:_(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean},emits:["change","exchange","update:code"],setup(e,{emit:n,slots:t}){const[u,a]=pe(),s=ae({tab:0,code:e.code}),i=l(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!s.code||s.code.length<e.exchangeMinLength)),b=()=>{n("exchange",s.code),e.code||(s.code="")},B=c=>{ie(()=>{u.value[c]&&u.value[c].scrollIntoView()})},y=()=>o("div",{class:r("empty")},[o("img",{src:e.emptyImage},null),o("p",null,[v("noCoupon")])]),D=()=>{if(e.showExchangeBar)return o("div",{class:r("exchange-bar")},[o(be,{modelValue:s.code,"onUpdate:modelValue":c=>s.code=c,clearable:!0,border:!1,class:r("field"),placeholder:e.inputPlaceholder||v("placeholder"),maxlength:"20"},null),o(Y,{plain:!0,type:"danger",class:r("exchange"),text:e.exchangeButtonText||v("exchange"),loading:e.exchangeButtonLoading,disabled:i.value,onClick:b},null)])},E=()=>{const{coupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.enabledTitle||v("enable"))+m;return o(q,{title:p},{default:()=>{var f;return[o("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map((h,T)=>o(Z,{key:h.id,ref:a(T),coupon:h,chosen:T===e.chosenCoupon,currency:e.currency,onClick:()=>n("change",T)},null)),!c.length&&y(),(f=t["list-footer"])==null?void 0:f.call(t)])]}})},F=()=>{const{disabledCoupons:c}=e,m=e.showCount?` (${c.length})`:"",p=(e.disabledTitle||v("disabled"))+m;return o(q,{title:p},{default:()=>{var f;return[o("div",{class:r("list",{"with-bar":e.showExchangeBar,"with-bottom":e.showCloseButton})},[c.map(h=>o(Z,{disabled:!0,key:h.id,coupon:h,currency:e.currency},null)),!c.length&&y(),(f=t["disabled-list-footer"])==null?void 0:f.call(t)])]}})};return A(()=>e.code,c=>{s.code=c}),A(()=>s.code,c=>n("update:code",c)),A(()=>e.displayedCouponIndex,B),se(()=>{B(e.displayedCouponIndex)}),()=>o("div",{class:r()},[D(),o(he,{active:s.tab,"onUpdate:active":c=>s.tab=c,class:r("tab"),border:!1},{default:()=>[E(),F()]}),o("div",{class:r("bottom")},[ce(o(Y,{round:!0,block:!0,type:"danger",class:r("close"),text:e.closeButtonText||v("close"),onClick:()=>n("change",-1)},null),[[ue,e.showCloseButton]])])])}});const Fe=S(Ee),un=k({setup(e){const n=ee({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),t=(m=999999)=>String(Math.floor(Math.random()*m)+1),u=I(!1),a=I(-1),s=I([]),i=l(()=>({id:1,condition:`\u65E0\u4F7F\u7528\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:n("coupon.name"),description:n("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),b=l(()=>C(x({},i.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),B=l(()=>C(x({},i.value),{id:3,reason:n("coupon.reason")})),y=l(()=>C(x({},b.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:n("coupon.reason")})),D=l(()=>[i.value,b.value,...s.value]),E=l(()=>[B.value,y.value]),F=m=>{u.value=!1,a.value=m},c=()=>{ge(n("exchange")),s.value.push(C(x({},i.value),{id:t()}))};return(m,p)=>{const f=le("demo-block");return de(),re(f,{title:g(n)("basicUsage")},{default:z(()=>[o(g(je),{coupons:g(D),"chosen-coupon":a.value,onClick:p[0]||(p[0]=h=>u.value=!0)},null,8,["coupons","chosen-coupon"]),o(g(me),{show:u.value,"onUpdate:show":p[1]||(p[1]=h=>u.value=h),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:z(()=>[o(g(Fe),{coupons:g(D),"chosen-coupon":a.value,"disabled-coupons":g(E),onChange:F,onExchange:c},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{un as default};
